<%= role = role || f.object.try(:user).try(:role) %>

<% raise f.object.role.inspect if role.nil? %>

<div class="nested-fields">
  <div>
    <%= f.collection_select :user_id, User.send(role.to_sym), :id, :email, :include_blank => "Select Investor", :class => 'form-control' %>
  </div>

  <%= link_to_remove_association "Remove", f, class: "btn btn-danger btn-sm" %>
</div>